---
import { Image } from "astro:assets";
import Layout from "../layouts/Layout.astro";
import { calculateYearDifference } from "../utils/dates";

const BIRTH_DATE = new Date("1995-09-27");
const PROGRAMMING_START_DATE = new Date("2020-10-10");

const aboutData = {
  title: "Hi!",
  image: "/images/work-pic.webp",
};

const myAge = calculateYearDifference(BIRTH_DATE);
const yearsProgramming = calculateYearDifference(PROGRAMMING_START_DATE);
---

<Layout title={aboutData.title}>
  <article
    class="prose dark:prose-invert prose-stone w-full max-w-none gap-4 flex flex-col items-center"
  >
    {
      aboutData.image && (
        <div class="w-full flex justify-center">
          <Image
            class="object-cover object-center !m-0 aspect-square block border-2 border-[#0000ee] dark:border-white retro-image-border"
            src={aboutData.image}
            alt="me"
            width={150}
            height={150}
          />
        </div>
      )
    }
    <div class="mt-2">
      <h1 id="title">
        {aboutData.title}
      </h1>
      <div
        id="about-content"
        class="text-sm leading-relaxed text-gray-700 prose mt-4 dark:text-white"
      >
        <span>
          I'm Marcel, a <span id="my-age">{myAge}</span>-year-old software developer based in Barcelona.
        </span>
        <br />
        <br />
        <span class="mt-1 block">
          With over <span id="years-programming">{yearsProgramming}</span> years of experience in the tech industry,  I specialize in frontend development using
          React and TypeScript, and backend development and tooling with Node.js
          and Ruby.
        </span>
        <br />
        <span>
          Currently, I'm working as a full-stack developer at <a
            href="https://www.worldsensing.com/"
            target="_blank"
            rel="noopener">Worldsensing</a
          >. In my free time, I'm expanding my skills by learning Rust and Go
          and contributing to open-source projects.
        </span>
        <br/>
      </div>
    </div>
  </article>
  <script>
    const BIRTH_DATE = new Date("1995-09-27");
    const PROGRAMMING_START_DATE = new Date("2020-10-10");

    function calculateYearDifference(from: Date) {
      const today = new Date();
      let years = today.getFullYear() - from.getFullYear();
      const hasHadBirthday =
        today.getMonth() > from.getMonth() ||
        (today.getMonth() === from.getMonth() && today.getDate() >= from.getDate());
      if (!hasHadBirthday) years--;
      return years;
    }

    const ageEl = document.getElementById("my-age");
    if (ageEl) ageEl.textContent = String(calculateYearDifference(BIRTH_DATE));

    const yearsEl = document.getElementById("years-programming");
    if (yearsEl) yearsEl.textContent = String(calculateYearDifference(PROGRAMMING_START_DATE));
  </script>
</Layout>

<style>
  #title {
    font-family: "Noto Serif Regular";
    font-size: 30px;
    margin-bottom: 4px;
  }

  #about-content {
    font-family: "IBM Plex Mono", monospace;
    font-size: clamp(15px, 4vw, 12px);
    font-weight: bold;
    text-align: justify;
    text-justify: inter-word;
  }

  a {
    color: #3182ce;
  }
</style>
